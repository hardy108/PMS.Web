@using PMS.Web.UI.Code
@using PMS.Shared.Models
@{
    Layout = null;
    string mode = ViewBag.Mode;
}


    <x-form id="@ViewBag.MainFormID">

        <x-form-row>
            <x-field-text xs-size="12" md-size="3" id="DOCNO" binding-field="DOCNO" caption="No. Dokumen" read-only="true" place-holder="Auto Number">
            </x-field-text>
            <x-field-data-list-divisi-by-user-name id="DIVID" xs-size="12" md-size="3" caption="Divisi"
                                                   multiple="false" binding-field="DIVID"
                                                   read-only="@ViewBag.ReadOnlyWhenNotInsert">
            </x-field-data-list-divisi-by-user-name>
            <x-field-date id="PREMIDATE" binding-field="PREMIDATE" caption="Tgl. Premi" read-only="@ViewBag.ReadOnly" xs-size="12" md-size="3" picker-option="DateOnly" date-format="dd-MMM-yyyy">
            </x-field-date>
            <x-field-text binding-field="STATUS_IN_TEXT" caption="Status" read-only="true" place-holder="Status" xs-size="12" md-size="3">
            </x-field-text>
            <input type="hidden" id="STATUS" data-bf="STATUS" />
        </x-form-row>
        <x-form-row>
            <x-field-data-list-employee id="EMPLOYEEID" xs-size="12" md-size="6" caption="Karyawan"
                                        value-field="EMPID" multiple="false" binding-field="EMPLOYEEID"
                                        ascendants="@(new List<FilterAscendant> { new FilterAscendant { FieldID = "DivisionID", ElementID= "DIVID" } })"
                                        chain-to-relatives="@(!ViewBag.ReadOnlyWhenNotInsert)"
                                        read-only="@ViewBag.ReadOnlyWhenNotInsert">
            </x-field-data-list-employee>

            <x-field-data-list-activity xs-size="12" md-size="6" caption="Kegiatan" id="ACTIVITYID" binding-field="ACTIVITYID" 
                read-only="@ViewBag.ReadOnly" min-length-search="2" 
                api-url-param="Nursery=true&GA=true">

            </x-field-data-list-activity>

        </x-form-row>

        <x-form-row>
            <x-field-number id="PREMIHK" binding-field="PREMIHK" caption="THR/Bonus (Rp)" read-only="@ViewBag.ReadOnly" md-size="3">
            </x-field-number>
            <x-field-number id="PREMIAMOUNT" binding-field="PREMIAMOUNT" caption="Premi Non Panen (Rp)" read-only="@ViewBag.ReadOnly" md-size="3">
            </x-field-number>
        </x-form-row>
        <x-form-row>
            <x-field-text-area binding-field="REMARK" id="REMARK" caption="Keterangan" read-only="@ViewBag.ReadOnly" place-holder="Keterangan" xs-size="12">
            </x-field-text-area>
        </x-form-row>
        <x-form-row>
            <x-field-input binding-field="REF" id="REF" caption="Referensi Dokumen" read-only="@ViewBag.ReadOnly" place-holder="Referensi" xs-size="12" md-size="6">
            </x-field-input>
        </x-form-row>
    </x-form>

<script>
        var mode = "@(mode)";
        var dictAllowedMode = {
            "": ["Edit", "Delete", "Display","New"],
            "A": ["Edit", "Delete", "Display","New"],
            "C": ["Display"],
            "D": ["Display"]
        };

        var checkMode = function () {
            if (typeof dictAllowedMode[record.STATUS] !== 'undefined') {
                var allowedMode = dictAllowedMode[record.STATUS];
                var allowed = false;
                if (Array.isArray(allowedMode) && allowedMode.length > 0) {
                    allowedMode.forEach(function (modeOk) {
                        if (modeOk === mode) {
                            allowed = true;
                            return;
                        }
                    });
                    if (!allowed) {
                        alert("Maaf anda tidak diijinkan untuk melakukan " + mode + " atas data ini");
                        mode = allowedMode[0];
                        return true;
                    }

                }
                if (!allowed) {
                    alert("Maaf anda tidak diijinkan untuk melakukan apapun atas data ini");
                    return false;
                }
            }
            return true;
        };



</script>